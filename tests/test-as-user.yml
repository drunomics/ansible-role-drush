# The playbook requires a running container, see run-container.yml.
---
- hosts: all:&{{ limit_groups | default('container') }}

  pre_tasks:
    - name: Add drunomics user
      user: name=drunomics
    - apt: pkg=php5-cli state=present

  roles:
    - { role: self,  become: true, become_user: drunomics }

  post_tasks:
    - name: Assert drush is installed and working
      shell: >
        ~/.composer/vendor/bin/drush --version
      become_user: drunomics
      become: true
      tags:
        - assert
